{"ast":null,"code":"var _jsxFileName = \"/Users/theo/Documents/GitHub/weekly-time-allocation/src/components/LoginButton.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { useIsAuthenticated, useMsal } from '@azure/msal-react';\nimport { loginRequest } from '../auth/authConfig';\nimport { Button } from './ui/button';\nimport { LogIn, LogOut } from 'lucide-react';\nimport { useCurrentUser, getUserInfo } from '../auth/AuthProvider';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const LoginButton = () => {\n  _s();\n  const {\n    instance,\n    accounts\n  } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const currentUser = useCurrentUser();\n  const userInfo = getUserInfo(currentUser);\n  const [isLoggingIn, setIsLoggingIn] = useState(false);\n  const [error, setError] = useState(null);\n  const handleLogin = async () => {\n    try {\n      if (isLoggingIn) return; // Prevent multiple login attempts\n\n      setIsLoggingIn(true);\n      setError(null);\n      console.log(\"Starting login process...\");\n\n      // Simplified login process - don't try to logout first\n      // This prevents potential redirect loops\n      await instance.loginRedirect({\n        ...loginRequest,\n        redirectStartPage: window.location.href // Ensure we come back to the same page\n      });\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      setError(\"Login failed. Please try again.\");\n      setIsLoggingIn(false); // Reset login state on error\n    }\n    // Note: We don't set isLoggingIn to false here because the page will redirect\n  };\n  const handleLogout = async () => {\n    try {\n      console.log(\"Starting logout process...\");\n      const account = instance.getActiveAccount();\n      if (account) {\n        await instance.logoutRedirect({\n          account,\n          postLogoutRedirectUri: window.location.origin\n        });\n      } else {\n        await instance.logoutRedirect();\n      }\n    } catch (error) {\n      console.error(\"Logout failed:\", error);\n    }\n  };\n\n  // If there's an error, show it\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-red-500 mr-2\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: () => setError(null),\n        variant: \"outline\",\n        children: \"Dismiss\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this);\n  }\n  if (isAuthenticated && userInfo) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mr-4 text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"font-medium text-slate-700\",\n          children: userInfo.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-slate-500 text-xs\",\n          children: userInfo.email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outline\",\n        onClick: handleLogout,\n        className: \"flex items-center\",\n        disabled: isLoggingIn,\n        children: [/*#__PURE__*/_jsxDEV(LogOut, {\n          className: \"h-4 w-4 mr-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this), \"Sign Out\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Button, {\n    onClick: handleLogin,\n    className: \"flex items-center bg-blue-600 hover:bg-blue-700\",\n    disabled: isLoggingIn,\n    children: [/*#__PURE__*/_jsxDEV(LogIn, {\n      className: \"h-4 w-4 mr-2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this), isLoggingIn ? \"Signing in...\" : \"Sign in with Microsoft\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n};\n_s(LoginButton, \"20rOSqfSjR0qL1KMHRAgQgZVpP8=\", false, function () {\n  return [useMsal, useIsAuthenticated, useCurrentUser];\n});\n_c = LoginButton;\nvar _c;\n$RefreshReg$(_c, \"LoginButton\");","map":{"version":3,"names":["React","useState","useIsAuthenticated","useMsal","loginRequest","Button","LogIn","LogOut","useCurrentUser","getUserInfo","jsxDEV","_jsxDEV","LoginButton","_s","instance","accounts","isAuthenticated","currentUser","userInfo","isLoggingIn","setIsLoggingIn","error","setError","handleLogin","console","log","loginRedirect","redirectStartPage","window","location","href","handleLogout","account","getActiveAccount","logoutRedirect","postLogoutRedirectUri","origin","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","variant","name","email","disabled","_c","$RefreshReg$"],"sources":["/Users/theo/Documents/GitHub/weekly-time-allocation/src/components/LoginButton.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useIsAuthenticated, useMsal } from '@azure/msal-react';\nimport { loginRequest } from '../auth/authConfig';\nimport { Button } from './ui/button';\nimport { LogIn, LogOut, User } from 'lucide-react';\nimport { useCurrentUser, getUserInfo } from '../auth/AuthProvider';\n\nexport const LoginButton: React.FC = () => {\n  const { instance, accounts } = useMsal();\n  const isAuthenticated = useIsAuthenticated();\n  const currentUser = useCurrentUser();\n  const userInfo = getUserInfo(currentUser);\n  const [isLoggingIn, setIsLoggingIn] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleLogin = async () => {\n    try {\n      if (isLoggingIn) return; // Prevent multiple login attempts\n      \n      setIsLoggingIn(true);\n      setError(null);\n      console.log(\"Starting login process...\");\n      \n      // Simplified login process - don't try to logout first\n      // This prevents potential redirect loops\n      await instance.loginRedirect({\n        ...loginRequest,\n        redirectStartPage: window.location.href // Ensure we come back to the same page\n      });\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      setError(\"Login failed. Please try again.\");\n      setIsLoggingIn(false); // Reset login state on error\n    }\n    // Note: We don't set isLoggingIn to false here because the page will redirect\n  };\n\n  const handleLogout = async () => {\n    try {\n      console.log(\"Starting logout process...\");\n      const account = instance.getActiveAccount();\n      if (account) {\n        await instance.logoutRedirect({\n          account,\n          postLogoutRedirectUri: window.location.origin\n        });\n      } else {\n        await instance.logoutRedirect();\n      }\n    } catch (error) {\n      console.error(\"Logout failed:\", error);\n    }\n  };\n\n  // If there's an error, show it\n  if (error) {\n    return (\n      <div className=\"flex items-center\">\n        <span className=\"text-red-500 mr-2\">{error}</span>\n        <Button \n          onClick={() => setError(null)}\n          variant=\"outline\"\n        >\n          Dismiss\n        </Button>\n      </div>\n    );\n  }\n\n  if (isAuthenticated && userInfo) {\n    return (\n      <div className=\"flex items-center\">\n        <div className=\"mr-4 text-sm\">\n          <div className=\"font-medium text-slate-700\">{userInfo.name}</div>\n          <div className=\"text-slate-500 text-xs\">{userInfo.email}</div>\n        </div>\n        <Button \n          variant=\"outline\" \n          onClick={handleLogout} \n          className=\"flex items-center\"\n          disabled={isLoggingIn}\n        >\n          <LogOut className=\"h-4 w-4 mr-2\" />\n          Sign Out\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <Button \n      onClick={handleLogin}\n      className=\"flex items-center bg-blue-600 hover:bg-blue-700\"\n      disabled={isLoggingIn}\n    >\n      <LogIn className=\"h-4 w-4 mr-2\" />\n      {isLoggingIn ? \"Signing in...\" : \"Sign in with Microsoft\"}\n    </Button>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}